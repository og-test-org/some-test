name: some test

on:
  push:

jobs:
  get-version:
    runs-on: ubuntu-latest
    steps:
    - name: checkout root
      uses: actions/checkout@v3
    - name: Commit and Push
      shell: bash
      run: |
        git config --global user.email "${{ github.actor }}@users.noreply.github.com"
        git config --global user.name "${{ github.actor }}"
        git status
        git checkout -b release-test-${{github.run_id}}
        touch test-${{github.run_id}}.txt
        git add .
        git commit --allow-empty -m "testing actions"
        git pull origin main --rebase
        git push --set-upstream origin release-test-${{github.run_id}}
        # gh pr create --title "Release" --body "ðŸš¦ Automerge: Enabled. " --fill
        # gh pr merge --auto --squash
        git checkout main
      env:
        GH_TOKEN: ${{ github.token }}
    - name: Run the Action
      uses: devops-infra/action-pull-request@v0.5.5
      with:
        github_token: ${{ github.token }}
        source_branch: release-test-${{github.run_id}}
        target_branch: main
        title: My pull request
        # template: .github/PULL_REQUEST_TEMPLATE.md
        body: "**Automated pull request**"
        reviewer: octocat
        assignee: octocat
        label: enhancement
        milestone: My milestone
        draft: false
        old_string: "<!-- Add your description here -->"
        new_string: "** Automatic pull request**"
        get_diff: true
        ignore_users: "dependabot"
        allow_no_diff: true
    - name: Check PR
      uses: JJ/github-pr-contains-action@releases/v10
      with:
        github-token: ${{github.token}}
        bodyDoesNotContain: "Delete|this"
        bodyContains: 'Test'
        diffContains: ';'
        diffDoesNotContain: "TODO|to do"
        filesChanged: 1
        linesChanged: 1

